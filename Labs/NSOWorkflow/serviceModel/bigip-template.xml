
[root@dmz-nso01 src]# cat ../templates/bigip-template.xml
<config-template xmlns="http://tail-f.com/ns/config/1.0">
  <devices xmlns="http://tail-f.com/ns/ncs">
    <device>
      <name>{/load-balancer/device-name}</name>
      <config>
        <ltm xmlns="http://tail-f.com/ned/f5-bigip">
          <virtual foreach="{/load-balancer/virtual-server}">
            <name>{name}</name>
            <vs-index>24</vs-index>
            <destination>{destination-ip}:{destination-port}</destination>
            <ip-protocol>tcp</ip-protocol>
            <mask>255.255.255.255</mask>
            <pool>{/load-balancer/pool/name}</pool>
            <profiles>
              <profile>
                <name>{profiles}</name>
              </profile>
            </profiles>
            <source>0.0.0.0/0</source>
            <source-address-translation>
              <type>automap</type>
            </source-address-translation>
            <translate-address>enabled</translate-address>
            <translate-port>enabled</translate-port>
          </virtual>

          <pool>
            <name>{/load-balancer/pool/name}</name>
            <load-balancing-mode>{/load-balancer/pool/load-balancing-mode}</load-balancing-mode>
            <members foreach="{/load-balancer/pool/members}">
              <member>
                <node_name>{name}</node_name>
                <port>{port}</port>
                <address>{ip-address}</address>
              </member>
            </members>
            <monitor>{/load-balancer/pool/monitor}</monitor>
          </pool>

          <node foreach="{/load-balancer/pool/members}">
            <name>{name}</name>
            <address>{ip-address}</address>
          </node>
        </ltm>

        <net xmlns="http://tail-f.com/ned/f5-bigip">
          <vlan foreach="{/load-balancer/vlans}">
            <name>{name}</name>
            <tag>{string(/aci-bigip:vlans[aci-bigip:name=current()/name]/aci-bigip:tag)}</tag>
            <interfaces foreach="{interfaces}">
              <interface>
                <name>{name}</name>
                <tagged when="{starts-with(tagging,'tagged')}"/>
                <tag-mode when="{starts-with(tagging,'tagged')}">service</tag-mode>
              </interface>
            </interfaces>
          </vlan>

          <self foreach="{/load-balancer/self-ip}">
            <name>{name}</name>
            <address>{ip-address}</address>
            <partition>Common</partition>
            <allow-service>default</allow-service>
            <vlan>{vlan}</vlan>
          </self>

          <route foreach="{/load-balancer/route}">
            <name>{name}</name>
            <gw>{gw-address}</gw>
            <network>{destination-network}</network>
          </route>
        </net>

      </config>
    </device>
  </devices>
</config-template>
